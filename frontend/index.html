<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FC Green</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="container">
        <header>
            <h1 class="header-title" style="cursor: pointer;">⚽ FC Green</h1>
            <div style="position: absolute; top: 20px; right: 20px;">
                <button id="login-btn" class="btn btn-primary" onclick="openLoginModal()" style="display: block;">Đăng nhập</button>
                <button id="logout-btn" class="btn btn-secondary" onclick="logout()" style="display: none;">Đăng xuất</button>
            </div>
        </header>

        <nav class="tabs">
            <button class="tab-btn active" data-tab="profile">Profile</button>
            <button class="tab-btn" data-tab="opponents">Đối thủ</button>
            <button class="tab-btn" data-tab="schedule">Lịch thi đấu</button>
            <button class="tab-btn" data-tab="statistics">Thống kê</button>
        </nav>

        <!-- Profile Tab -->
        <div id="profile-tab" class="tab-content active">
            <div class="two-column-layout">
                <div class="main-content">
                    <!-- Players Section -->
                    <div class="profile-section">
                        <div class="section-header">
                            <h2>Players</h2>
                            <button class="btn btn-primary" onclick="openPlayerModal()">+ Add Player</button>
                        </div>
                        <div id="players-list" class="cards-grid">
                            <!-- Players will be loaded here -->
                        </div>
                    </div>
                </div>
                <div class="sidebar" id="team-profile-sidebar">
                    <div class="sidebar-header">
                        <h3>Team Profile</h3>
                        <button class="btn-icon" onclick="closeTeamProfile()" title="Close">×</button>
                    </div>
                    <div class="sidebar-content" id="team-profile-content">
                        <div class="empty-sidebar">
                            <p>Click Edit to view/edit profile</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Opponents Tab -->
        <div id="opponents-tab" class="tab-content">
            <div class="section-header">
                <h2>Đối thủ</h2>
                <button class="btn btn-primary" onclick="openOpponentModal()">+ Thêm đối thủ</button>
            </div>
            <div id="opponents-list" class="cards-grid">
                <!-- Opponents will be loaded here -->
            </div>
        </div>

        <!-- Schedule Tab -->
        <div id="schedule-tab" class="tab-content">
            <div class="section-header">
                <h2>Lịch thi đấu</h2>
                <button class="btn btn-primary" onclick="openMatchModal()">+ Thêm lịch thi đấu</button>
            </div>
            <!-- Subtabs for schedule -->
            <div class="sub-tabs">
                <button class="sub-tab-btn active" data-subtab="upcoming" onclick="switchScheduleSubTab('upcoming')">Lịch thi đấu tiếp theo</button>
                <button class="sub-tab-btn" data-subtab="completed" onclick="switchScheduleSubTab('completed')">Trận đấu đã hoàn thành</button>
            </div>
            <!-- Upcoming matches -->
            <div id="upcoming-matches-list" class="subtab-content active timeline-container">
                <!-- Upcoming matches will be loaded here -->
            </div>
            <!-- Completed matches -->
            <div id="completed-matches-list" class="subtab-content timeline-container">
                <!-- Month filter -->
                <div style="margin-bottom: 20px; display: flex; align-items: center; gap: 15px; flex-wrap: wrap;">
                    <label for="month-filter" style="font-weight: 600; color: #333; white-space: nowrap;">Lọc theo tháng:</label>
                    <select id="month-filter" onchange="filterCompletedMatchesByMonth()" style="padding: 8px 15px; border: 2px solid #e9ecef; border-radius: 8px; font-size: 1em; background: white; color: #333; cursor: pointer; min-width: 200px;">
                        <option value="">Tất cả các tháng</option>
                    </select>
                </div>
                <!-- Completed matches will be loaded here -->
            </div>
        </div>

        <!-- Statistics Tab -->
        <div id="statistics-tab" class="tab-content">
            <div class="section-header">
                <h2>Danh sách ghi bàn</h2>
            </div>
            <div class="goal-stats-container">
                <!-- Top 3 Players -->
                <div class="top-goalscorers">
                    <h3>Top 3 cầu thủ ghi bàn</h3>
                    <div id="top-goalscorers-circles" class="top-goalscorers-circles">
                        <!-- Top 3 circles will be loaded here -->
                    </div>
                </div>
                <!-- Goals Table -->
                <div class="goals-table-container">
                    <h3>Chi tiết ghi bàn</h3>
                    <div id="goals-table-wrapper">
                        <!-- Goals table will be loaded here -->
                    </div>
                </div>
                <!-- Participation Statistics -->
                <div class="participation-stats-container">
                    <h3>Thống kê tham gia trận đấu</h3>
                    <div id="participation-table-wrapper">
                        <!-- Participation table will be loaded here -->
                    </div>
                </div>
                <!-- Bubble Chart -->
                <div class="bubble-chart-container">
                    <h3>Biểu đồ bong bóng ghi bàn</h3>
                    <div id="goals-bubbles-container" class="goals-bubbles-container">
                        <!-- Bubbles will be loaded here -->
                    </div>
                </div>
            </div>
        </div>

        <!-- Match Modal -->
        <div id="match-modal" class="modal">
            <div class="modal-content">
                <span class="close" onclick="closeMatchModal()">&times;</span>
                <h2 id="match-modal-title">Thêm lịch thi đấu</h2>
                <form id="match-form" onsubmit="saveMatch(event)">
                    <input type="hidden" id="match-id">
                    <div class="form-group">
                        <label>Đối thủ *</label>
                        <div style="display: flex; gap: 10px; align-items: flex-start;">
                            <select id="match-opponent-id" required style="flex: 1;">
                                <option value="">Chọn đối thủ</option>
                            </select>
                            <button type="button" class="btn btn-secondary" onclick="openOpponentModalFromMatch()" style="white-space: nowrap;">+ Thêm mới</button>
                        </div>
                    </div>
                    <div class="form-group">
                        <label>Thời gian thi đấu *</label>
                        <input type="datetime-local" id="match-date" required>
                    </div>
                    <div class="form-group">
                        <label style="display: flex; align-items: center; gap: 10px; cursor: pointer;">
                            <input type="checkbox" id="match-is-completed" style="width: auto; margin: 0;">
                            <span>Đã hoàn thành</span>
                        </label>
                        <small style="color: #6c757d; display: block; margin-top: 5px;">Tích vào đây nếu trận đấu đã kết thúc</small>
                    </div>
                    <div class="form-actions">
                        <button type="button" class="btn btn-secondary" onclick="closeMatchModal()">Hủy</button>
                        <button type="submit" class="btn btn-primary">Lưu</button>
                    </div>
                </form>
            </div>
        </div>

        <!-- Match Result Modal -->
        <div id="match-result-modal" class="modal">
            <div class="modal-content">
                <span class="close" onclick="closeMatchResultModal()">&times;</span>
                <h2 id="match-result-modal-title">Cập nhật kết quả trận đấu</h2>
                <form id="match-result-form" onsubmit="saveMatchResult(event)">
                    <input type="hidden" id="match-result-id">
                    <div class="form-group">
                        <label>Kết quả *</label>
                        <div class="radio-group" style="display: flex; gap: 20px; margin-top: 10px;">
                            <label style="display: flex; align-items: center; gap: 5px;">
                                <input type="radio" name="match-result" value="win" required>
                                <span>Thắng</span>
                            </label>
                            <label style="display: flex; align-items: center; gap: 5px;">
                                <input type="radio" name="match-result" value="draw" required>
                                <span>Hòa</span>
                            </label>
                            <label style="display: flex; align-items: center; gap: 5px;">
                                <input type="radio" name="match-result" value="lose" required>
                                <span>Thua</span>
                            </label>
                        </div>
                    </div>
                    <div class="form-group">
                        <label>Tỉ số *</label>
                        <div class="score-input-group" style="display: flex; align-items: center; gap: 15px; margin-top: 10px;">
                            <div style="flex: 1;">
                                <label style="font-size: 0.9em; color: #666;">FC Green</label>
                                <input type="number" id="match-our-score" min="0" required style="width: 100%;">
                            </div>
                            <span style="font-size: 1.5em; font-weight: bold;">-</span>
                            <div style="flex: 1;">
                                <label style="font-size: 0.9em; color: #666;" id="match-result-opponent-label">Đối thủ</label>
                                <input type="number" id="match-opponent-score" min="0" required style="width: 100%;">
                            </div>
                        </div>
                    </div>
                    <div class="form-group">
                        <label>Danh sách tham gia trận đấu *</label>
                        <div id="match-participants-container" class="positions-container" style="max-height: 200px; overflow-y: auto; border: 2px solid #e9ecef; border-radius: 6px; padding: 10px;">
                            <!-- Participants checkboxes will be added here dynamically -->
                        </div>
                        <small style="color: #6c757d; display: block; margin-top: 5px;">Tích vào các cầu thủ có tham gia trận đấu (bắt buộc chọn ít nhất 1 cầu thủ)</small>
                    </div>
                    <div class="form-group">
                        <label>Cầu thủ ghi bàn</label>
                        <div id="match-goals-container">
                            <!-- Goal entries will be added here dynamically -->
                        </div>
                        <button type="button" class="btn btn-secondary btn-small" onclick="addGoalEntry()" style="margin-top: 10px;">+ Thêm cầu thủ ghi bàn</button>
                    </div>
                    <div class="form-actions">
                        <button type="button" class="btn btn-secondary" onclick="closeMatchResultModal()">Hủy</button>
                        <button type="submit" class="btn btn-primary">Lưu</button>
                    </div>
                </form>
            </div>
        </div>

        <!-- Opponent Modal -->
        <div id="opponent-modal" class="modal">
            <div class="modal-content">
                <span class="close" onclick="closeOpponentModal()">&times;</span>
                <h2 id="opponent-modal-title">Thêm đối thủ</h2>
                <form id="opponent-form" onsubmit="saveOpponent(event)">
                    <input type="hidden" id="opponent-id">
                    <div class="form-group">
                        <label>Tên đối thủ *</label>
                        <input type="text" id="opponent-name" required>
                    </div>
                    <div class="form-group">
                        <label>Số điện thoại liên hệ</label>
                        <input type="tel" id="opponent-phone" placeholder="0912345678">
                    </div>
                    <div class="form-group">
                        <label>Đánh giá (5 sao) *</label>
                        <div class="star-rating" style="display: flex; gap: 5px; margin: 10px 0;">
                            <input type="hidden" id="opponent-rating" value="0" required>
                            <span class="star" data-rating="1" onclick="setRating(1)" style="font-size: 2em; cursor: pointer; color: #ddd;">★</span>
                            <span class="star" data-rating="2" onclick="setRating(2)" style="font-size: 2em; cursor: pointer; color: #ddd;">★</span>
                            <span class="star" data-rating="3" onclick="setRating(3)" style="font-size: 2em; cursor: pointer; color: #ddd;">★</span>
                            <span class="star" data-rating="4" onclick="setRating(4)" style="font-size: 2em; cursor: pointer; color: #ddd;">★</span>
                            <span class="star" data-rating="5" onclick="setRating(5)" style="font-size: 2em; cursor: pointer; color: #ddd;">★</span>
                        </div>
                        <small style="color: #6c757d; display: block; margin-top: 5px;">Click vào sao để đánh giá (1-5 sao)</small>
                    </div>
                    <div class="form-group">
                        <label>Nhận xét</label>
                        <textarea id="opponent-review" rows="4" placeholder="Nhập nhận xét về đối thủ..."></textarea>
                    </div>
                    <div class="form-actions">
                        <button type="button" class="btn btn-secondary" onclick="closeOpponentModal()">Hủy</button>
                        <button type="submit" class="btn btn-primary">Lưu</button>
                    </div>
                </form>
            </div>
        </div>

        <!-- Player Modal -->
        <div id="player-modal" class="modal">
            <div class="modal-content">
                <span class="close" onclick="closePlayerModal()">&times;</span>
                <h2 id="player-modal-title">Add Player</h2>
                <form id="player-form" onsubmit="savePlayer(event)">
                    <input type="hidden" id="player-id">
                    <div class="form-group">
                        <label>Name *</label>
                        <input type="text" id="player-name" required>
                    </div>
                    <div class="form-group">
                        <label>Profile Image</label>
                        <div class="image-upload-tabs">
                            <button type="button" class="tab-upload-btn active" data-tab="url" onclick="switchImageTab('url')">URL</button>
                            <button type="button" class="tab-upload-btn" data-tab="upload" onclick="switchImageTab('upload')">Upload</button>
                        </div>
                        <div id="image-url-tab" class="image-upload-content active">
                            <input type="text" id="player-profile-image" placeholder="https://example.com/image.jpg or /uploads/player-image/filename.jpg" oninput="updateImagePreview(this.value)">
                            <small style="color: #6c757d; display: block; margin-top: 5px;">Enter image URL or path</small>
                        </div>
                        <div id="image-upload-tab" class="image-upload-content">
                            <input type="file" id="player-image-file" accept="image/*" onchange="handleImageUpload(event)">
                            <small style="color: #6c757d; display: block; margin-top: 5px;">Choose image from your computer (max 5MB)</small>
                            <div id="upload-progress" style="display: none; margin-top: 10px;">
                                <small style="color: #667eea;">Uploading...</small>
                            </div>
                        </div>
                        <div class="profile-image-container">
                            <img id="player-image-preview" class="profile-image-preview" style="display: none;" onerror="this.style.display='none'">
                        </div>
                    </div>
                    <div class="form-group">
                        <label>Position * (Select multiple)</label>
                        <div id="player-positions-container" class="positions-container">
                            <!-- Positions will be rendered here -->
                        </div>
                        <small style="color: #6c757d; display: block; margin-top: 5px;">Select one or more positions</small>
                    </div>
                    <div class="form-group">
                        <label>Jersey Number</label>
                        <input type="number" id="player-jersey-number">
                    </div>
                    <div class="form-group">
                        <label>Chức vụ *</label>
                        <select id="player-role" required>
                            <option value="Cầu thủ">Cầu thủ</option>
                            <option value="Đội phó">Đội phó</option>
                            <option value="Đội trưởng">Đội trưởng</option>
                        </select>
                        <small style="color: #6c757d; display: block; margin-top: 5px;">Chọn chức vụ của cầu thủ</small>
                    </div>
                    <div class="form-actions">
                        <button type="button" class="btn btn-secondary" onclick="closePlayerModal()">Cancel</button>
                        <button type="submit" class="btn btn-primary">Save</button>
                    </div>
                </form>
            </div>
        </div>

        <!-- Loading Overlay -->
        <div id="loading" class="loading" style="display: none;">
            <div class="spinner"></div>
        </div>

        <!-- Login Modal -->
        <div id="login-modal" class="modal">
            <div class="modal-content">
                <span class="close" onclick="closeLoginModal()">&times;</span>
                <h2>Đăng nhập</h2>
                <form id="login-form" onsubmit="handleLogin(event)">
                    <div class="form-group">
                        <label>Username *</label>
                        <input type="text" id="login-username" required autocomplete="username">
                    </div>
                    <div class="form-group">
                        <label>Password *</label>
                        <input type="password" id="login-password" required autocomplete="current-password">
                    </div>
                    <div id="login-error" style="color: #dc3545; margin-bottom: 15px; display: none;"></div>
                    <div class="form-actions">
                        <button type="button" class="btn btn-secondary" onclick="closeLoginModal()">Hủy</button>
                        <button type="submit" class="btn btn-primary">Đăng nhập</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Upcoming Match Modal (Circle) -->
    <div id="upcoming-match-modal" class="modal circle-modal">
        <div class="modal-backdrop" onclick="closeUpcomingMatchModal()"></div>
        <div class="circle-modal-content">
            <button class="circle-modal-close" onclick="closeUpcomingMatchModal()">&times;</button>
            <div id="upcoming-match-content">
                <!-- Content will be loaded here -->
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
    <script src="positions.js"></script>
    <script src="api.js"></script>
    <script src="app.js"></script>
</body>
</html>

